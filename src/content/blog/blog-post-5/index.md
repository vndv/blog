---
title: "10 основных проверок качества данных в SQL"
date: "2023-13-09"
tags:
  - "SQL"
description: "10 основных проверок качества данных в SQL"
---

В эпоху больших данных и аналитики, качество данных играет важную роль в принятии обоснованных решений. Однако обеспечение качества данных может быть сложной задачей, требующей тщательных проверок и подтверждений.

В этой статье мы рассмотрим 10 основных проверок качества данных с использованием  SQL. Мы посмотрим как можно выявить такие проблемы, как пропущенные значения, дубликаты, несогласованность данных и многое другое.

# Data Quality Checks

Набор данных **«orders_received»** представляет собой вымышленную коллекцию данных, в которой собрана информация о заказах, полученных компанией.
Этот набор данных предоставляет ценную информацию о торговых операциях компании, позволяя проводить анализ и процессы принятия решений.
Он включает ключевые атрибуты, такие как **«order_number»** — уникальный идентификатор каждого заказа; **«product_code»**, который указывает конкретный заказываемый продукт; **«customer_id»**, используемый для связи заказов с соответствующими клиентами; «количество», обозначающее количество заказанного продукта; и **«order_date»**, указывающий дату получения заказа.
В совокупности эти атрибуты дают полную картину полученных заказов, способствуя росту бизнеса и инициативам по удовлетворению потребностей клиентов.

```json
{
  "type": "object",
  "properties": {
    "order_number": { "type": "integer" },
    "product_code": { "type": "string" },
    "customer_id": { "type": "integer" },
    "quantity": { "type": "integer" },
    "order_date": { "type": "string", "format": "date" }
  }
}
```

### Проверка значений NULL

Этот пример помогает идентифицировать заказы в таблице **«orders_received»**, у которых отсутствуют номера заказов. Это позволяет найти любые неполные или неправильно записанные заказы.

```sql
SELECT * FROM orders_received WHERE order_number IS NULL;
```

### Подсчет уникальных значений

Этот метод поможет вам посчитать коды продуктов в таблице **«orders_received»**. 
Это позволяет вам определить, существует ли несколько вхождений одного и того же кода продукта, что может указывать на ошибки ввода данных или дубликаты.

```sql
-- Получение всех значений, появляющихся более одного раза
SELECT product_code, COUNT(*) AS count
FROM orders_received
GROUP BY product_code
HAVING COUNT(*) > 1;
```

### Проверка типов данных

В этом примере проверяется, содержит ли столбец «количество» в таблице **«orders_received»** только числовые значения.
Это помогает выявить случаи присутствия нечисловых или неправильно отформатированных данных.

```sql
SELECT * FROM orders_received WHERE quantity::text !~ '^[0-9]+$';
```

### Выявление дубликатов

Этот запрос помогает найти повторяющиеся номера заказов в таблице **«orders_received»**. Это позволяет вам выявлять любые заказы, которые могли быть записаны несколько раз, обеспечивая точность данных и предотвращая потенциальные ошибки.

```sql
SELECT order_number, COUNT(*) AS duplicate_count
FROM orders_received
GROUP BY order_number
HAVING COUNT(*) > 1;
```

### Проверка целостности данных с помощью внешних ключей

В этом примере проверяется, что **«customer_id»** в таблице **«orders_received»** соответствует действительным записям клиентов в таблице **«customers»**. Это помогает поддерживать ссылочную целостность, гарантируя, что все заказы связаны с существующими клиентами.

```sql
SELECT *
FROM orders_received
WHERE customer_id NOT IN (SELECT customer_id FROM customers);
```

### Проверка диапазона данных

Этот запрос проверяет, попадает ли **«order_date»** в указанный диапазон, например, в определенный год. Это помогает гарантировать, что заказы, записанные в таблице **«orders_received»**, соответствуют определенным временным ограничениям или бизнес-правилам.

```sql
SELECT *
FROM orders_received
WHERE order_date < '2023-01-01' OR order_date > '2023-12-31';
```

### Идентификация записей с недействительными или противоречивыми форматами

В этом примере определяются значения **«product_code»** в таблице **«orders_received»**, которые не соответствуют желаемому буквенно-цифровому формату. Это помогает идентифицировать любые записи, которые могли быть записаны неправильно или содержать недопустимые символы.

```sql
SELECT *
FROM orders_received
WHERE NOT REGEXP_LIKE(product_code, '^[A-Za-z0-9]+$');
```

### Обнаружение выбросов или необычных значений

Этот запрос выявляет любые необычно высокие или низкие количества, сравнивая значения **«quantity»** в таблице **«orders_received»** с их статистическим распределением. Это помогает обнаружить потенциальные ошибки ввода данных или выбросы, которые значительно отклоняются от нормы.

```sql
SELECT *
FROM orders_received
WHERE quantity < (SELECT AVG(quantity) - (3 * STDDEV(quantity)) FROM orders_received)
   OR quantity > (SELECT AVG(quantity) + (3 * STDDEV(quantity)) FROM orders_received);
```

### Обнаружение устаревших данных

Обнаружение устаревших данных — важный аспект проверки качества данных, позволяющий обеспечить своевременность и актуальность набора данных **"orders_received"**.
Устаревшие данные — это устаревшая информация, которая больше не отражает текущее состояние бизнеса.
Выполняя проверки устаревших данных, вы можете выявить записи, которые могли устареть или стать неактуальными из-за нехватки времени. 
Это помогает поддерживать точность и надежность набора данных, позволяя принимать более обоснованные решения и анализировать. 
Предположим, наши данные должны представлять заказы только за последние 90 дней.

```sql
SELECT *
FROM orders_received
WHERE order_date < CURRENT_DATE - INTERVAL '90 days';
```

### Обнаружение изменения данных

Обнаружение изменения данных — это важная проверка качества данных, которая помогает идентифицировать записи в наборе данных **«orders_received»**, значения которых были изменены или обновлены после определенной контрольной точки. 
Эта проверка позволяет выявить случаи неожиданного изменения данных, что может быть результатом повреждения данных или ошибок вручную. 
Выполняя эту проверку, вы можете обеспечить точность и согласованность набора данных для надежного анализа и принятия решений.

Чтобы обнаружить изменение данных, вам обычно необходимо иметь контрольную точку или набор исторических данных для сравнения с текущим набором данных. 
Сравнивая соответствующие значения между эталонным набором данных и текущим набором данных, вы можете выявить любые различия или изменения в данных.

```sql
SELECT *
FROM orders_received
WHERE EXISTS (
  SELECT *
  FROM orders_reference
  WHERE orders_reference.order_number = orders_received.order_number
    AND (
      orders_reference.order_date <> orders_received.order_date
      OR orders_reference.quantity <> orders_received.quantity
    )
);
```

### Заключение
Внедрив эти проверки качества данных, вы можете быть уверены в точности своих данных и принимать надежные решения на основе высококачественной информации.
 Качество данных — это непрерывный процесс, и эти методы служат важными инструментами для обеспечения целостности и полезности ваших наборов данных.